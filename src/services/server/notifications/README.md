This can probably be made a little more abstract and generic to reduce boilerplate code.
